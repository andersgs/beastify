?phyclust::seqgen()
?phyclust::seqgen
test_fasta <- ape::read.dna( file = "test_data/test.fasta", format = 'fasta' )
test_gff <- readr::read_csv( file = "test_data/test.gff" )
test_gff <- readr::read_csv( file = "test_data/test.gff", comment = "#" )
test_gff <- readr::read_tsv( file = "test_data/test.gff", comment = "#", col_names = F )
head( test_gff )
names( test_gff ) <- c( "reference", "source","feature", "start", "end", "score", "strand", "phase", "description" )
library( dplyr )
test_gff %>% dplyr::filter( feature == 'CDS' )
test_gff %>% dplyr::filter( feature == 'RNA' )
test_gff %>% dplyr::filter( feature == 'tRNA' )
?match
test_gff %>% dplyr::filter( grepl( pattern = 'RNA', x = feature )
)
test_gff %>% dplyr::filter( grepl( pattern = 'rna', x = feature ) )
test_gff %>% dplyr::summarise( unique( feature ))
test_gff %>% dplyr::summarise( unique( feature ) )
test_gff %>% dplyr::group_by( feature ) %>% dplyr::summarise( count = n() )
test_gff %>%
dplyr::group_by( feature ) %>%
dplyr::mutate( feature_length = end - start + 1 ) %>%
dplyr::summarise( sum( feature_length ) )
head( test_gff )
seq( 89, 688, 3 )
seq( 90, 688, 3 )
seq( 91, 688, 3 )
seq(688, 89, 3)
?seq
reverse( seq( 89, 688, 3 ) )
rev( seq( 89, 688, 3 ) )
head( test_gff )
test_gff %>%
dplyr::filter( feature == 'CDS' )
data.frame( start = test_gff$end[-nrow(test_gff)] + 1, end = test_gff$start[-1]) - 1)
data.frame( start = test_gff$end[-nrow(test_gff)] + 1, end = test_gff$start[-1] - 1)
head( data.frame( start = test_gff$end[-nrow(test_gff)] + 1, end = test_gff$start[-1] - 1) )
test_gff %>% dplyr::filter( feature != 'source' )
test_gff <- test_gff %>%
dplyr::filter( feature != 'source' )
head( data.frame( start = test_gff$end[-nrow(test_gff)] + 1, end = test_gff$start[-1] - 1) )
test_gff_cds <- test_gff %>%
dplyr::filter( feature == 'CDS' )
test_gff_cds <- test_gff %>%
dplyr::filter( feature == 'CDS' ) %>%
dplyr::select( end, start ) %>%
dplyr::mutate( start = end, end = start )
test_gff %>%
dplyr::filter( feature == 'CDS' ) %>%
dplyr::select( end, start ) %>%
dplyr::mutate( start = end, end = start )
test_gff %>%
dplyr::filter( feature == 'CDS' ) %>%
dplyr::select( end, start )
test_gff %>%
dplyr::filter( feature == 'CDS' ) %>%
dplyr::select( end[-nrow( test_gff )], start[-1] )
test_gff_cds <- test_gff %>%
dplyr::filter( feature == 'CDS' )
test_gff_cdd
test_gff_cds
test_gff_cds <- test_gff %>%
dplyr::filter( feature == 'CDS' ) %>%
dplyr::select( end, start )
test_gff_cds
head( data.frame( start = test_gf_cdsf$end[-nrow(test_gff)] + 1, end = test_gff_cds$start[-1] - 1) )
head( data.frame( start = test_gf_cds$end[-nrow(test_gff)] + 1, end = test_gff_cds$start[-1] - 1) )
head( data.frame( start = test_gff_cds$end[-nrow(test_gff)] + 1, end = test_gff_cds$start[-1] - 1) )
nrow(test_gff)
head( data.frame( start = test_gff_cds$end[-167] + 1, end = test_gff_cds$start[-1] - 1) )
head( data.frame( start = test_gff_cds$end[-167], end = test_gff_cds$start[-1]) )
test_gff_cds$start[-1]
test_gff_cds$end[-167]
head( data.frame( start = test_gff_cds$end, end = test_gff_cds$start) )
head( data.frame( start = test_gff_cds$end, end = test_gff_cds$start[-1]) )
nrow( test_gff_cds)
head( data.frame( start = test_gff_cds$end[-nrow( test_gff_cds )], end = test_gff_cds$start[-1]) )
head( data.frame( start = test_gff_cds$end[-nrow( test_gff_cds )] + 1 , end = test_gff_cds$start[-1]) - 1 )
head( data.frame( start = (test_gff_cds$end[-nrow( test_gff_cds )] + 1) , end = test_gff_cds$start[-1]) - 1 )
head( data.frame( start = (test_gff_cds$end[-nrow( test_gff_cds )] + 1) , end = test_gff_cds$start[-1]) )
head( data.frame( start = (test_gff_cds$end[-nrow( test_gff_cds )] + 1) ,
end = (test_gff_cds$start[-1] - 1) )
head( data.frame( start = (test_gff_cds$end[-nrow( test_gff_cds )] + 1) ,
end = (test_gff_cds$start[-1] - 1) ) )
head( data.frame( start = (test_gff_cds$end[-nrow( test_gff_cds )] + 1), end = (test_gff_cds$start[-1] - 1) ) )
intergenetic_regions <- data.frame( start = (test_gff_cds$end[-nrow( test_gff_cds )] + 1),
end = (test_gff_cds$start[-1] - 1) )
intergenetic_regions %>%
dplyr::mutate( length_intergenic = end - start + 1)
head( test_gff_cds )
intergenetic_regions %>%
dplyr::mutate( length_intergenic = end - start + 1)
head( test_gff_cds, n = 8 )
head( test_gff_cds, n = 9 )
test_gff %>% dplyr::filter( start = 7920 )
test_gff
test_gff %>% dplyr::filter( end = 7920 )
test_gff %>% dplyr::filter( end == 7920 )
test_gff %>% dplyr::filter( end == 7923 )
test_gff %>% dplyr::filter( start == 7923 )
test_gff %>% dplyr::filter( start == 7920 )
test_gff %>% dplyr::filter( start == 7920 ) %>% dplyr::select( description )
test_gff %>% dplyr::filter( end == 7923 ) %>% dplyr::select( description )
test_gff %>% dplyr::filter( end == 7923 ) %>% dplyr::select( start, end description )
test_gff %>% dplyr::filter( end == 7923 ) %>% dplyr::select( start, end, description )
test_gff %>% dplyr::filter( start == 7920 ) %>% dplyr::select( start, end, description )
test_gff %>% dplyr::filter( start == 7920 ) %>% dplyr::select( description )
test_gff %>% dplyr::filter( start == 7920 | end == 7923 ) %>% dplyr::select( description )
test_gff %>% dplyr::filter( start == 7920 | end == 7923 ) %>% dplyr::select( start, end, description )
test_gff %>% dplyr::filter( start == 7920 | end == 7923 )
8720 - 7920
8720 - 7920  + 1
801/3
7923 - 7108 + 1
816/3
intergenetic_regions %>%
dplyr::mutate( length_intergenic = end - start + 1) %>%
dplyr::filter( length_intergenic < 0 )
intergenetic_regions %>%
dplyr::mutate( length_intergenic = end - start + 1) %>%
dplyr::filter( length_intergenic > 0 )
intergenetic_regions %>%
dplyr::mutate( length_intergenic = end - start + 1) %>%
dplyr::filter( length_intergenic > 0 ) %>%
dplyr::summarise( sum( length_intergenic ) )
test_gff %>%
dplyr::group_by( feature ) %>%
dplyr::mutate( feature_length = end - start + 1 ) %>%
dplyr::summarise( sum( feature_length ) )
88758 + 12019
test_gff[1, ]
100801 - nice make -j 18 -C /home/agoncalves/MDU/JOBS/vre_snapshot/nullarbor
100801 - 100777
test_gff %>%
dplyr::group_by( feature ) %>%
dplyr::mutate( feature_length = end - start + 1 )
test_gff %>%
dplyr::group_by( feature ) %>%
dplyr::mutate( feature_length = end - start + 1 ) %>%
dplyr::select( feature_length, description )
test_gff %>%
dplyr::group_by( feature ) %>%
dplyr::mutate( feature_length = end - start + 1 ) %>%
dplyr::select( feature_length, description )
test_gff %>%
dplyr::group_by( feature ) %>%
dplyr::mutate( feature_length = end - start + 1 ) %>%
dplyr::select( feature_length, description )
dplyr::select( description )
test_gff %>%
dplyr::group_by( feature ) %>%
dplyr::mutate( feature_length = end - start + 1 ) %>%
dplyr::select( description )
test_gff$description
